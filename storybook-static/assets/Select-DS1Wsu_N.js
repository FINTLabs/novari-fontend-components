import{r as f,R as v}from"./iframe-C9GtWCFt.js";import{c as M,S as K,a as H,o as $}from"./useId-BxoADsoD.js";import{c as C}from"./composeEventHandlers-krbYd5LM.js";import{o as V}from"./owner-Cl3CaANg.js";import{u as S,a as Z,b as X,R as q}from"./useFormField-8b588JVz.js";import{R as G}from"./index-BB_C-hE4.js";import{L as J,a as Q,E as Y}from"./Label-DpB5uiKT.js";import{S as ee}from"./ChevronDown-ChZ9QaOW.js";function te(n,r){const s=[],e=new Set,t=new Map;r.forEach((a,u)=>{a.forEach(c=>{c!==u&&t.set(c,u)})});const o=a=>{if(e.has(a))return;const u=t.get(a);if(u&&!e.has(u)&&(o(u),e.has(a)))return;e.add(a),s.push(a);const c=r.get(a);c&&c.forEach(o)};return n.forEach(o),s}function ne(n,r=globalThis?.document,s=!0){const e=S(n);f.useEffect(()=>{if(!s)return;const t=o=>{o.key==="Escape"&&e(o)};return r.addEventListener("keydown",t,!0),()=>{r.removeEventListener("keydown",t,!0)}},[e,r,s])}const j={FOCUS_OUTSIDE:"AKSEL_FOCUS_OUTSIDE",POINTER_DOWN_OUTSIDE:"AKSEL_POINTER_DOWN_OUTSIDE"};function k(n,r,s,{discrete:e}={discrete:!1}){if(!r)return;const t=s.originalEvent.target,o=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:s});t.addEventListener(n,r,{once:!0}),e&&t?G.flushSync(()=>t.dispatchEvent(o)):t.dispatchEvent(o)}function re(n,r=globalThis?.document,s=!0){const e=S(n),t=f.useRef(!1);return f.useEffect(()=>{if(!s)return;const o=a=>{if(a.target&&!t.current){const u={originalEvent:a};k(j.FOCUS_OUTSIDE,e,u)}};return r.addEventListener("focusin",o),()=>{r.removeEventListener("focusin",o)}},[r,e,s]),{onFocusCapture:()=>{t.current=!0},onBlurCapture:()=>{t.current=!1}}}function se(n,r=globalThis?.document,s=!0){const e=S(n),t=f.useRef(!1),o=f.useRef(()=>{}),a=Z();return f.useEffect(()=>{if(!s)return;const u=c=>{function h(){k(j.POINTER_DOWN_OUTSIDE,e,{originalEvent:c},{discrete:!0})}c.target&&!t.current?c.pointerType==="touch"?(r.removeEventListener("click",o.current),o.current=h,r.addEventListener("click",o.current,{once:!0})):h():r.removeEventListener("click",o.current),t.current=!1};return a.start(0,()=>{r.addEventListener("pointerdown",u)}),()=>{r.removeEventListener("pointerdown",u),r.removeEventListener("click",o.current)}},[r,e,a,s]),{onPointerDownCapture:()=>{t.current=!0}}}var oe=function(n,r){var s={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.indexOf(e)<0&&(s[e]=n[e]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(n);t<e.length;t++)r.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(n,e[t])&&(s[e[t]]=n[e[t]]);return s};const U=v.createContext(null),L="dismissableLayer.update";let W;const ie=v.createContext({layers:new Set,branchedLayers:new Map,layersWithOutsidePointerEventsDisabled:new Set}),me=f.forwardRef((n,r)=>{var{children:s,disableOutsidePointerEvents:e,onDismiss:t,onInteractOutside:o,onEscapeKeyDown:a,onFocusOutside:u,onPointerDownOutside:c,safeZone:h,asChild:g,enabled:p=!0}=n,m=oe(n,["children","disableOutsidePointerEvents","onDismiss","onInteractOutside","onEscapeKeyDown","onFocusOutside","onPointerDownOutside","safeZone","asChild","enabled"]);const d=f.useContext(ie),[,D]=f.useState({}),[l,y]=v.useState(null),P=M(r,y),E=V(l),_=te(d.layers,d.branchedLayers),T=ae(_,d.layersWithOutsidePointerEventsDisabled),R=l?_.indexOf(l):-1,z=d.layersWithOutsidePointerEventsDisabled.size>0,I=T===-1||R>=T;function N(i){if(!h?.anchor)return;let w=!1;i.defaultPrevented||i.detail.originalEvent.type==="pointerdown"&&(w=!0);const F=i.target;(h.anchor.contains(F)||F===h.anchor)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&w&&i.preventDefault()}const A=se(i=>{I&&(c?.(i),o?.(i),h&&N(i),!i.defaultPrevented&&t&&t())},E,p),x=re(i=>{u?.(i),o?.(i),h&&N(i),!i.defaultPrevented&&t&&t()},E,p);ne(i=>{R===d.layers.size-1&&(a?.(i),!i.defaultPrevented&&t&&(i.preventDefault(),t()))},E,p),f.useEffect(()=>{if(!(!l||!p))return e&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(W=E.body.style.pointerEvents,E.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(l)),d.layers.add(l),b(),()=>{e&&d.layersWithOutsidePointerEventsDisabled.size===1&&(E.body.style.pointerEvents=W)}},[l,p,e,d,E]),f.useEffect(()=>()=>{l&&(d.layers.has(l)||d.layersWithOutsidePointerEventsDisabled.has(l))&&(d.layers.delete(l),d.layersWithOutsidePointerEventsDisabled.delete(l),b())},[l,d,p]);const O=f.useContext(U);f.useEffect(()=>{if(!l||!p||!O||l===O)return;d.branchedLayers.has(O)||d.branchedLayers.set(O,new Set);const i=d.branchedLayers.get(O);return i.add(l),b(),()=>{i.delete(l),i.size===0&&d.branchedLayers.delete(O),b()}},[l,p,O,d]),f.useEffect(()=>{const i=()=>D({});return document.addEventListener(L,i),()=>document.removeEventListener(L,i)},[]);const B=g?K:"div";return v.createElement(U.Provider,{value:l},v.createElement(B,Object.assign({},m,{ref:P,style:Object.assign({pointerEvents:z?I?"auto":"none":void 0},m.style),onFocusCapture:C(m.onFocusCapture,x.onFocusCapture),onBlurCapture:C(m.onBlurCapture,x.onBlurCapture),onPointerDownCapture:C(m.onPointerDownCapture,A.onPointerDownCapture)}),s))});function b(){const n=new CustomEvent(L);document.dispatchEvent(n)}function ae(n,r){for(let s=n.length-1;s>=0;s-=1)if(r.has(n[s]))return s;return-1}var de=function(n,r){var s={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.indexOf(e)<0&&(s[e]=n[e]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(n);t<e.length;t++)r.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(n,e[t])&&(s[e[t]]=n[e[t]]);return s};const Oe=f.forwardRef((n,r)=>{const{inputProps:s,errorId:e,showErrorMsg:t,hasError:o,size:a,inputDescriptionId:u,readOnly:c}=X(n,"select"),{children:h,label:g,className:p,description:m,hideLabel:d=!1,style:D}=n,l=de(n,["children","label","className","description","hideLabel","style"]),{cn:y}=H(),P={onMouseDown:E=>{c&&(E.preventDefault(),E.target.focus())},onKeyDown:E=>{c&&["ArrowDown","ArrowUp","ArrowRight","ArrowLeft"," "].includes(E.key)&&E.preventDefault()}};return v.createElement("div",{className:y(p,"navds-form-field",`navds-form-field--${a}`,{"navds-form-field--disabled":!!s.disabled,"navds-form-field--readonly":c,"navds-select--error":o,"navds-select--readonly":c})},v.createElement(J,{htmlFor:s.id,size:a,className:y("navds-form-field__label",{"navds-sr-only":d})},c&&v.createElement(q,null),g),!!m&&v.createElement(Q,{className:y("navds-form-field__description",{"navds-sr-only":d}),id:u,size:a,as:"div"},m),v.createElement("div",{className:y("navds-select__container"),style:D},v.createElement("select",Object.assign({},$(l,["error","errorId","size","readOnly"]),s,P,{ref:r,className:y("navds-select__input","navds-body-short",`navds-body-short--${a??"medium"}`)}),h),v.createElement(ee,{className:y("navds-select__chevron"),"aria-hidden":!0})),v.createElement("div",{className:y("navds-form-field__error"),id:e,"aria-relevant":"additions removals","aria-live":"polite"},t&&v.createElement(Y,{size:a,showIcon:!0},n.error)))});export{me as D,Oe as S};
